<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Jaybird 3.0.4 Release Notes</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">table td {
vertical-align: text-top;
}
table tr:nth-child(even) {
background-color: #f2f2f2
}
table thead th {
border-bottom: 1px solid black;
}</style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header>
<h1 class="title">Jaybird 3.0.4 Release Notes</h1>
</header>
<nav id="TOC">
<ul>
<li><a href="#general-notes"><span class="toc-section-number">1</span> General Notes</a><ul>
<li><a href="#about-this-version"><span class="toc-section-number">1.1</span> About this version</a></li>
<li><a href="#supported-firebird-versions"><span class="toc-section-number">1.2</span> Supported Firebird versions</a><ul>
<li><a href="#notes-on-firebird-3-support"><span class="toc-section-number">1.2.1</span> Notes on Firebird 3 support</a></li>
</ul></li>
<li><a href="#supported-java-versions"><span class="toc-section-number">1.3</span> Supported Java versions</a></li>
<li><a href="#specification-support"><span class="toc-section-number">1.4</span> Specification support</a></li>
</ul></li>
<li><a href="#getting-jaybird-3.0"><span class="toc-section-number">2</span> Getting Jaybird 3.0</a><ul>
<li><a href="#jaybird-3.0.4"><span class="toc-section-number">2.1</span> Jaybird 3.0.4</a><ul>
<li><a href="#maven"><span class="toc-section-number">2.1.1</span> Maven</a></li>
<li><a href="#download"><span class="toc-section-number">2.1.2</span> Download</a></li>
</ul></li>
</ul></li>
<li><a href="#upgrading-from-jaybird-2.2-to-jaybird-3.0"><span class="toc-section-number">3</span> Upgrading from Jaybird 2.2 to Jaybird 3.0</a><ul>
<li><a href="#maven-1"><span class="toc-section-number">3.1</span> Maven</a></li>
<li><a href="#manual-install"><span class="toc-section-number">3.2</span> Manual install</a></li>
<li><a href="#gotchas"><span class="toc-section-number">3.3</span> Gotcha’s</a></li>
</ul></li>
<li><a href="#jaybird-3.0.x-changelog"><span class="toc-section-number">4</span> Jaybird 3.0.x changelog</a><ul>
<li><a href="#changes-in-jaybird-3.0.4"><span class="toc-section-number">4.1</span> Changes in Jaybird 3.0.4</a><ul>
<li><a href="#known-issues-in-jaybird-3.0.4"><span class="toc-section-number">4.1.1</span> Known issues in Jaybird 3.0.4</a></li>
</ul></li>
<li><a href="#changes-in-jaybird-3.0.3"><span class="toc-section-number">4.2</span> Changes in Jaybird 3.0.3</a></li>
<li><a href="#changes-in-jaybird-3.0.2"><span class="toc-section-number">4.3</span> Changes in Jaybird 3.0.2</a></li>
<li><a href="#changes-in-jaybird-3.0.1"><span class="toc-section-number">4.4</span> Changes in Jaybird 3.0.1</a></li>
<li><a href="#changes-in-jaybird-3.0.0"><span class="toc-section-number">4.5</span> Changes in Jaybird 3.0.0</a></li>
<li><a href="#changes-in-jaybird-3.0.0-beta-3"><span class="toc-section-number">4.6</span> Changes in Jaybird 3.0.0-beta-3</a></li>
<li><a href="#changes-in-jaybird-3.0.0-beta-2"><span class="toc-section-number">4.7</span> Changes in Jaybird 3.0.0-beta-2</a></li>
</ul></li>
<li><a href="#whats-new-in-jaybird-3.0"><span class="toc-section-number">5</span> What’s new in Jaybird 3.0</a><ul>
<li><a href="#java-support"><span class="toc-section-number">5.1</span> Java support</a><ul>
<li><a href="#java-6"><span class="toc-section-number">5.1.1</span> Java 6</a></li>
<li><a href="#java-7-and-8"><span class="toc-section-number">5.1.2</span> Java 7 and 8</a></li>
<li><a href="#java-9"><span class="toc-section-number">5.1.3</span> Java 9</a></li>
</ul></li>
<li><a href="#firebird-support"><span class="toc-section-number">5.2</span> Firebird support</a><ul>
<li><a href="#other-firebird-feature-support"><span class="toc-section-number">5.2.1</span> Other Firebird feature support</a></li>
</ul></li>
<li><a href="#new-low-level-implementation"><span class="toc-section-number">5.3</span> New low-level implementation</a></li>
<li><a href="#support-for-java.util.logging-added"><span class="toc-section-number">5.4</span> Support for java.util.logging added</a></li>
<li><a href="#support-for-log4j-1.x-removed"><span class="toc-section-number">5.5</span> Support for log4j 1.x removed</a></li>
<li><a href="#ipv6-address-literal-support-in-connection-string"><span class="toc-section-number">5.6</span> IPv6 address literal support in connection string</a></li>
<li><a href="#wire-encryption-support"><span class="toc-section-number">5.7</span> Wire encryption support</a></li>
<li><a href="#database-encryption-support"><span class="toc-section-number">5.8</span> Database encryption support</a></li>
<li><a href="#potentially-breaking-changes"><span class="toc-section-number">5.9</span> Potentially breaking changes</a><ul>
<li><a href="#specifying-connection-character-set-is-now-required"><span class="toc-section-number">5.9.1</span> Specifying connection character set is now required</a></li>
<li><a href="#antlr-4-runtime"><span class="toc-section-number">5.9.2</span> ANTLR 4 runtime</a></li>
<li><a href="#handling-of-character-set-octets"><span class="toc-section-number">5.9.3</span> Handling of character set OCTETS</a></li>
<li><a href="#changes-to-character-set-handling"><span class="toc-section-number">5.9.4</span> Changes to character set handling</a></li>
</ul></li>
<li><a href="#other-fixes-and-changes"><span class="toc-section-number">5.10</span> Other fixes and changes</a></li>
<li><a href="#removal-of-deprecated-classes-and-packages"><span class="toc-section-number">5.11</span> Removal of deprecated classes and packages</a></li>
</ul></li>
<li><a href="#known-issues"><span class="toc-section-number">6</span> Known Issues</a></li>
<li><a href="#compatibility-changes"><span class="toc-section-number">7</span> Compatibility changes</a><ul>
<li><a href="#character-set-handling"><span class="toc-section-number">7.1</span> Character set handling</a><ul>
<li><a href="#character-set-octets-handled-as-jdbc-varbinary"><span class="toc-section-number">7.1.1</span> Character set OCTETS handled as JDBC (VAR)BINARY</a></li>
<li><a href="#connection-character-set-none"><span class="toc-section-number">7.1.2</span> Connection character set NONE</a></li>
<li><a href="#connection-rejected-without-an-explicit-character-set"><span class="toc-section-number">7.1.3</span> Connection rejected without an explicit character set</a></li>
<li><a href="#connecting-without-explicit-character-set"><span class="toc-section-number">7.1.4</span> Connecting without explicit character set</a></li>
</ul></li>
<li><a href="#logging"><span class="toc-section-number">7.2</span> Logging</a></li>
<li><a href="#exceptions"><span class="toc-section-number">7.3</span> Exceptions</a></li>
<li><a href="#firebird-1.0-and-1.5-no-longer-supported"><span class="toc-section-number">7.4</span> Firebird 1.0 and 1.5 no longer supported</a></li>
<li><a href="#java-5-and-6-no-longer-supported"><span class="toc-section-number">7.5</span> Java 5 and 6 no longer supported</a></li>
<li><a href="#stricter-jdbc-compliance"><span class="toc-section-number">7.6</span> Stricter JDBC compliance</a><ul>
<li><a href="#general"><span class="toc-section-number">7.6.1</span> General</a></li>
<li><a href="#statement"><span class="toc-section-number">7.6.2</span> Statement</a></li>
<li><a href="#preparedstatement"><span class="toc-section-number">7.6.3</span> PreparedStatement</a></li>
<li><a href="#callablestatement"><span class="toc-section-number">7.6.4</span> CallableStatement</a></li>
<li><a href="#resultset"><span class="toc-section-number">7.6.5</span> ResultSet</a></li>
<li><a href="#clob"><span class="toc-section-number">7.6.6</span> Clob</a></li>
<li><a href="#databasemetadata"><span class="toc-section-number">7.6.7</span> DatabaseMetaData</a></li>
</ul></li>
<li><a href="#removal-of-old-gds-api"><span class="toc-section-number">7.7</span> Removal of old GDS API</a></li>
<li><a href="#type-2-native-and-embedded-driver"><span class="toc-section-number">7.8</span> Type 2 (native) and embedded driver</a></li>
<li><a href="#removal-of-deprecated-classes-packages-and-methods"><span class="toc-section-number">7.9</span> Removal of deprecated classes, packages and methods</a><ul>
<li><a href="#datasource-and-connection-pooling"><span class="toc-section-number">7.9.1</span> DataSource and connection pooling</a></li>
<li><a href="#firebirdsavepoint"><span class="toc-section-number">7.9.2</span> FirebirdSavepoint</a></li>
<li><a href="#reducing-visibility-of-implementation"><span class="toc-section-number">7.9.3</span> Reducing visibility of implementation</a></li>
<li><a href="#fbmaintenancemanager"><span class="toc-section-number">7.9.4</span> FBMaintenanceManager</a></li>
</ul></li>
<li><a href="#miscellaneous"><span class="toc-section-number">7.10</span> Miscellaneous</a></li>
<li><a href="#breaking-changes-for-jaybird-3.1"><span class="toc-section-number">7.11</span> Breaking changes for Jaybird 3.1</a></li>
<li><a href="#breaking-changes-for-jaybird-4"><span class="toc-section-number">7.12</span> Breaking changes for Jaybird 4</a><ul>
<li><a href="#dropping-support-for-firebird-2.0-and-2.1"><span class="toc-section-number">7.12.1</span> Dropping support for Firebird 2.0 and 2.1</a></li>
<li><a href="#dropping-support-for-java-7"><span class="toc-section-number">7.12.2</span> Dropping support for Java 7</a></li>
<li><a href="#removal-of-deprecated-methods"><span class="toc-section-number">7.12.3</span> Removal of deprecated methods</a></li>
<li><a href="#removal-of-deprecated-constants"><span class="toc-section-number">7.12.4</span> Removal of deprecated constants</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<section id="general-notes" class="level1">
<h1><span class="header-section-number">1</span> General Notes</h1>
<p>Jaybird is a JCA/JDBC driver suite to connect to Firebird database servers.</p>
<p>This driver is based on both the JCA standard for application server connections to enterprise information systems and the well-known JDBC standard. The JCA standard specifies an architecture in which an application server can cooperate with a driver so that the application server manages transactions, security, and resource pooling, and the driver supplies only the connection functionality. While similar to the JDBC XADataSource concept, the JCA specification is considerably clearer on the division of responsibility between the application server and driver.</p>
<section id="about-this-version" class="level2">
<h2><span class="header-section-number">1.1</span> About this version</h2>
<p>Jaybird 3.0 is a big change from Jaybird 2.2 and earlier. The entire low-level implementation has been rewritten to be able to support protocol improvements in newer Firebird versions. We have also made changes with a stricter interpretation of the JDBC requirements, and removed some parts that were either obsolete or not functioning correctly.</p>
<p>We recommend that you do not consider Jaybird 3.0 a drop-in replacement for Jaybird 2.2, and study these release notes carefully. Test your application with Jaybird 3.0 before using it in production.</p>
<p>Bug reports about undocumented changes in behavior are appreciated. Feedback can be sent to the Firebird-java mailing list or reported on the issue tracker <a href="http://tracker.firebirdsql.org/browse/JDBC" class="uri">http://tracker.firebirdsql.org/browse/JDBC</a>.</p>
</section>
<section id="supported-firebird-versions" class="level2">
<h2><span class="header-section-number">1.2</span> Supported Firebird versions</h2>
<p>Jaybird 3.0 was tested against Firebird 2.5.8, and 3.0.3, but should also support other Firebird versions from 2.0 and up.</p>
<p>Formal support for Firebird 1.x has been dropped (although in general we expect the driver to work). The Type 2 and embedded server JDBC drivers use JNA to access the Firebird client or embedded library.</p>
<p>This driver does not support InterBase servers due to Firebird-specific changes in the protocol and database attachment parameters that are sent to the server.</p>
<p>Jaybird 3.0 is the last version to support Firebird 2.0 and 2.1.</p>
<section id="notes-on-firebird-3-support" class="level3">
<h3><span class="header-section-number">1.2.1</span> Notes on Firebird 3 support</h3>
<p>Jaybird 3.0.4 added support for wire protocol encryption and database encryption. See <a href="#wire-encryption-support">Wire encryption support</a> and <a href="#database-encryption-support">Database encryption support</a> for more information.</p>
<p>Jaybird 3.0 does not support the Firebird 3 zlib compression.</p>
</section>
</section>
<section id="supported-java-versions" class="level2">
<h2><span class="header-section-number">1.3</span> Supported Java versions</h2>
<p>Jaybird 3.0 supports Java 7 (JDBC 4.1) and Java 8 (JDBC 4.2). Support for earlier Java versions has been dropped.</p>
<p>Basic support for Java 9 (JDBC 4.3) is available using the Java 8 version, but real module support will not be available until Jaybird 4 (or later).</p>
</section>
<section id="specification-support" class="level2">
<h2><span class="header-section-number">1.4</span> Specification support</h2>
<p>Jaybird supports the following specifications:</p>
<table>
<colgroup>
<col style="width: 16%"></col>
<col style="width: 83%"></col>
</colgroup>
<thead>
<tr class="header">
<th>Specification</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>JDBC 4.3</td>
<td>Driver implements all JDBC 4.3 methods for features supported by Firebird; Java 9 supported using the Java 8 driver.</td>
</tr>
<tr class="even">
<td>JDBC 4.2</td>
<td>Driver implements all JDBC 4.2 methods for features supported by Firebird.</td>
</tr>
<tr class="odd">
<td>JDBC 4.1</td>
<td>Driver implements all JDBC 4.1 methods for features supported by Firebird.</td>
</tr>
<tr class="even">
<td>JDBC 4.0</td>
<td>Driver implements all JDBC 4.0 interfaces and supports exception chaining.</td>
</tr>
<tr class="odd">
<td>JCA 1.0</td>
<td>Jaybird provides implementation of <code>javax.resource.spi.ManagedConnectionFactory</code> and related interfaces. CCI interfaces are not supported. Although Jaybird depends on the JCA 1.5 classes, JCA 1.5 compatibility is currently not guaranteed.</td>
</tr>
<tr class="even">
<td>JTA 1.0.1</td>
<td>Driver provides an implementation of <code>javax.transaction.xa.XAResource</code> interface via JCA framework and <code>XADataSource</code> implementation.</td>
</tr>
<tr class="odd">
<td>JMX 1.2</td>
<td>Jaybird provides a MBean to manage Firebird servers and installed databases via JMX agent.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="getting-jaybird-3.0" class="level1">
<h1><span class="header-section-number">2</span> Getting Jaybird 3.0</h1>
<section id="jaybird-3.0.4" class="level2">
<h2><span class="header-section-number">2.1</span> Jaybird 3.0.4</h2>
<section id="maven" class="level3">
<h3><span class="header-section-number">2.1.1</span> Maven</h3>
<p>Jaybird 3.0.4 is available from Maven central:</p>
<p>Groupid: <code>org.firebirdsql.jdbc</code>,<br />
Artifactid: <code>jaybird-jdkXX</code> (where <code>XX</code> is <code>17</code> or <code>18</code>).<br />
Version: <code>3.0.4</code></p>
<p>For example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">&lt;dependency&gt;</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">    <span class="kw">&lt;groupId&gt;</span>org.firebirdsql.jdbc<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">    <span class="kw">&lt;artifactId&gt;</span>jaybird-jdk18<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    <span class="kw">&lt;version&gt;</span>3.0.4<span class="kw">&lt;/version&gt;</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">&lt;/dependency&gt;</span></a></code></pre></div>
<p>If your application is deployed to a Java EE application server, you will need to exclude the <code>javax.resource:connector-api</code> dependency, and add it as a provided dependency:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">&lt;dependency&gt;</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">    <span class="kw">&lt;groupId&gt;</span>org.firebirdsql.jdbc<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="kw">&lt;artifactId&gt;</span>jaybird-jdk18<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="kw">&lt;version&gt;</span>3.0.4<span class="kw">&lt;/version&gt;</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">    <span class="kw">&lt;exclusions&gt;</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">        <span class="kw">&lt;exclusion&gt;</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">            <span class="kw">&lt;groupId&gt;</span>javax.resource<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8">            <span class="kw">&lt;artifactId&gt;</span>connector-api<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">        <span class="kw">&lt;/exclusion&gt;</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">    <span class="kw">&lt;/exclusions&gt;</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="kw">&lt;/dependency&gt;</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="kw">&lt;dependency&gt;</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">    <span class="kw">&lt;groupId&gt;</span>javax.resource<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">    <span class="kw">&lt;artifactId&gt;</span>connector-api<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">    <span class="kw">&lt;version&gt;</span>1.5<span class="kw">&lt;/version&gt;</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">    <span class="kw">&lt;scope&gt;</span>provided<span class="kw">&lt;/scope&gt;</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw">&lt;/dependency&gt;</span></a></code></pre></div>
<p>If you want to use Type 2 support (native, local or embedded), you need to explicitly include JNA 4.4.0 as a dependency:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">&lt;dependency&gt;</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">    <span class="kw">&lt;groupId&gt;</span>net.java.dev.jna<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="kw">&lt;artifactId&gt;</span>jna<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="kw">&lt;version&gt;</span>4.4.0<span class="kw">&lt;/version&gt;</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">&lt;/dependency&gt;</span></a></code></pre></div>
<p>We plan to make native and embedded support a separate library in future releases, and provide Firebird client libraries as Maven dependencies as well.</p>
<p>See also <a href="#type-2-native-and-embedded-driver">Type 2 (native) and embedded driver</a>.</p>
</section>
<section id="download" class="level3">
<h3><span class="header-section-number">2.1.2</span> Download</h3>
<p>You can download the latest versions from <a href="https://www.firebirdsql.org/en/jdbc-driver/" class="uri">https://www.firebirdsql.org/en/jdbc-driver/</a></p>
<p>At minimum Jaybird 3.0 requires <code>jaybird-3.0.4.jar</code> and <code>connector-api-1.5.jar</code>. You can also use <code>jaybird-full-3.0.4.jar</code> which includes the connector-api files.</p>
<p>If you deploy your application to a Java EE application server, then you must use <code>jaybird-3.0.4.jar</code> (not <code>-full</code>!), and <strong>not</strong> include <code>connector-api-1.5.jar</code> as this dependency will be provided by your application server.</p>
<p>For <code>getGeneratedKeys</code> support you will need to include <code>antlr-runtime-4.7.jar</code> on your classpath.</p>
<p>For native, local or embedded support, you will need to include <code>jna-4.4.0.jar</code> on your classpath. See also <a href="#type-2-native-and-embedded-driver">Type 2 (native) and embedded driver</a>.</p>
</section>
</section>
</section>
<section id="upgrading-from-jaybird-2.2-to-jaybird-3.0" class="level1">
<h1><span class="header-section-number">3</span> Upgrading from Jaybird 2.2 to Jaybird 3.0</h1>
<section id="maven-1" class="level2">
<h2><span class="header-section-number">3.1</span> Maven</h2>
<p>Upgrade the version of the dependency to 3.0.4. If you use native or embedded, you will no longer need the <code>jaybird22.dll</code> or <code>libjaybird22.so</code>, see the next section.</p>
<p>For more detailed instructions, see also the information on Maven in <a href="#getting-jaybird-3.0">Getting Jaybird 3.0</a>.</p>
</section>
<section id="manual-install" class="level2">
<h2><span class="header-section-number">3.2</span> Manual install</h2>
<p>If you manage your dependencies manually, you need to do the following:</p>
<ol type="1">
<li>Replace the Jaybird library 2.2 with the 3.0
<ul>
<li><code>jaybird-2.2.x.jar</code> with <code>jaybird-3.0.4.jar</code></li>
<li><code>jaybird-full-2.2.x.jar</code> with <code>jaybird-full-3.0.4.jar</code></li>
</ul></li>
<li><p>If installed, remove <code>antlr-runtime-3.4.jar</code> and replace it with <code>antlr-runtime-4.7.jar</code>. This library is necessary for <code>getGeneratedKeys</code> support.</p></li>
<li>If you use native (or embedded) you can remove the native library:
<ul>
<li><code>jaybird22.dll</code>,</li>
<li><code>libjaybird22.so</code>,</li>
<li><code>jaybird22_x64.jar</code> or</li>
<li><code>libjaybird22_x64.so</code></li>
</ul>
<p>Instead you need to add <code>jna-4.4.0.jar</code> to the classpath of your application. This library is necessary for native, local and embedded support. For more information, see <a href="#type-2-native-and-embedded-driver">Type 2 (native) and embedded driver</a></p></li>
</ol>
</section>
<section id="gotchas" class="level2">
<h2><span class="header-section-number">3.3</span> Gotcha’s</h2>
<p>During tests we have have observed that using Jaybird 4 with Firebird 3.0.4 may cause connection hangs when the connection is encrypted (the connection is blocked in a read from the socket). The cause seems related to the Java version (the problem disappeared with Java 9 Update 4), or possibly the <code>TcpRemoteBufferSize</code> setting in Firebird. The workaround is to disable wire encryption in Firebird or for the specific connection (see <a href="#wire-encryption-support">Wire encryption support</a>).</p>
<p>If you find a problem while upgrading, or other bugs: please report it on <a href="http://tracker.firebirdsql.org/brows/JDBC" class="uri">http://tracker.firebirdsql.org/brows/JDBC</a>.</p>
</section>
</section>
<section id="jaybird-3.0.x-changelog" class="level1">
<h1><span class="header-section-number">4</span> Jaybird 3.0.x changelog</h1>
<section id="changes-in-jaybird-3.0.4" class="level2">
<h2><span class="header-section-number">4.1</span> Changes in Jaybird 3.0.4</h2>
<p>The following has been changed or fixed since Jaybird 3.0.3</p>
<ul>
<li>New feature: Back-ported wire encryption support from Jaybird 4 (<a href="http://tracker.firebirdsql.org/browse/JDBC-415">JDBC-415</a>)<br />
See <a href="#wire-encryption-support">Wire encryption support</a> for more information.</li>
<li>Fixed: Native/embedded (JNA) connections truncate varchars to length 255 on read (<a href="http://tracker.firebirdsql.org/browse/JDBC-518">JDBC-518</a>)<br />
This fix was contributed by <a href="https://github.com/artyom-smirnov">Artyom Smirnov</a></li>
<li>New feature: Database encryption callback support in pure Java protocol (<a href="http://tracker.firebirdsql.org/browse/JDBC-527">JDBC-527</a>)<br />
For more information, see <a href="#database-encryption-support">Database encryption support</a>.<br />
This feature was sponsored by IBPhoenix.</li>
</ul>
<section id="known-issues-in-jaybird-3.0.4" class="level3">
<h3><span class="header-section-number">4.1.1</span> Known issues in Jaybird 3.0.4</h3>
<ul>
<li>When using native or embedded, the default JNA 4.4.0 dependency may not work on some versions of Linux as it requires glibc 2.14. Upgrading the dependency to JNA 4.5.x will solve this, as it requires glibc 2.7. See <a href="http://tracker.firebirdsql.org/browse/JDBC-509">JDBC-509</a>.<br />
We decided not to upgrade the dependency in a point release. JNA 4.5.x can be specified as a Maven dependency or can be downloaded from <a href="https://github.com/java-native-access/jna#download" class="uri">https://github.com/java-native-access/jna#download</a> or from <a href="http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22net.java.dev.jna%22%20AND%20a%3A%22jna%22">Maven Central</a></li>
<li>Jaybird 3.0.4 for Java 7 introduced a dependency on JAXB. When using Java 9 or higher make sure to use the Jaybird 3.0.4 binaries for Java 8. If you use Wildlfy or JBoss on Java 7, you will need to declare a dependency on JAXB, see <a href="https://www.firebirdsql.org/file/documentation/drivers_documentation/java/faq.html#wildfly">FAQ: Compatibility Notes &gt; Wildfly</a> for details.</li>
</ul>
</section>
</section>
<section id="changes-in-jaybird-3.0.3" class="level2">
<h2><span class="header-section-number">4.2</span> Changes in Jaybird 3.0.3</h2>
<p>The following has been changed or fixed since Jaybird 3.0.2</p>
<ul>
<li>Fixed: Some older versions of JBoss would throw an <code>java.lang.IllegalStateException:  Can't overwrite cause</code> when <code>FBResourceException</code> initialised its exception cause. (<a href="http://tracker.firebirdsql.org/browse/JDBC-512">JDBC-512</a>)</li>
<li>Improved: Added explicit <code>Automatic-Module-Name: org.firebirdsql.jaybird</code> to manifest for forwards compatibility with Java 9 modularization. (<a href="http://tracker.firebirdsql.org/browse/JDBC-511">JDBC-511</a>)</li>
</ul>
</section>
<section id="changes-in-jaybird-3.0.2" class="level2">
<h2><span class="header-section-number">4.3</span> Changes in Jaybird 3.0.2</h2>
<p>The following has been changed or fixed since Jaybird 3.0.1</p>
<ul>
<li>Fixed: Specifying an unknown Java character set in connection property <code>charSet</code> or <code>localEncoding</code> was handled as if no connection character set had been specified, now we throw an exception that the character set is unknown. (<a href="http://tracker.firebirdsql.org/browse/JDBC-498">JDBC-498</a>)</li>
<li>Changed: Specifying a connection character set is no longer required, and will now default to <code>NONE</code> again, if system property <code>org.firebirdsql.jdbc.defaultConnectionEncoding</code> is not specified. (<a href="http://tracker.firebirdsql.org/browse/JDBC-502">JDBC-502</a>)<br />
The new requirement turned out to be too restrictive and hindering adoption of Jaybird 3. If you do want strict behaviour, you can specify system property <code>org.firebirdsql.jdbc.requireConnectionEncoding</code> with value <code>true</code>. See <a href="#connecting-without-explicit-character-set">Connecting without explicit character set</a> for more information.</li>
</ul>
</section>
<section id="changes-in-jaybird-3.0.1" class="level2">
<h2><span class="header-section-number">4.4</span> Changes in Jaybird 3.0.1</h2>
<p>The following has been changed or fixed since Jaybird 3.0.0</p>
<ul>
<li>Fixed: <code>FBTraceManager.loadConfigurationFromFile</code> strips line breaks (<a href="http://tracker.firebirdsql.org/browse/JDBC-493">JDBC-493</a>)</li>
<li>Fixed: <code>FBDatabaseMetaData.getTables</code> does not list tables where <code>rdb$relation_type</code> is <code>null</code> (<a href="http://tracker.firebirdsql.org/browse/JDBC-494">JDBC-494</a>)</li>
<li>Improvement: Character sets are now initialized lazily (<a href="http://tracker.firebirdsql.org/browse/JDBC-495">JDBC-495</a>)<br />
Under Excelsior Jet, the eager loading of character sets could lead to slow initialization if character sets were excluded from the build.</li>
<li>Fixed: Memory leak caused by retaining blob handles until connection close (<a href="http://tracker.firebirdsql.org/browse/JDBC-497">JDBC-497</a>)</li>
</ul>
</section>
<section id="changes-in-jaybird-3.0.0" class="level2">
<h2><span class="header-section-number">4.5</span> Changes in Jaybird 3.0.0</h2>
<p>The following has been changed or fixed since Jaybird 3.0.0-beta-3</p>
<ul>
<li>Changed: Remove automatic retrieval of sql counts in the low-level API on execute or after fetching all rows (<a href="http://tracker.firebirdsql.org/browse/JDBC-482">JDBC-482</a><br />
This restores the behavior of Jaybird 2.2 and should result in a minor performance improvement when (fully) reading result sets or using <code>execute</code> instead of <code>executeUpdate</code> and <strong>not</strong> obtaining update counts.</li>
<li>Fixed: Database connection in NetBeans 8.2 fails (<a href="http://tracker.firebirdsql.org/browse/JDBC-483">JDBC-483</a>)</li>
<li>New feature: added method <code>getDatabaseTransactionInfo</code> to <code>StatisticsManager</code> to retrieve oldest, oldest active, oldest snapshot and next transaction, and the active transaction count (<a href="http://tracker.firebirdsql.org/browse/JDBC-485">JDBC-485</a>)<br />
The active transaction count is only available in Firebird 2 and higher, for Firebird 1.5 and earlier this will have value <code>-1</code>.<br />
A static <code>FBStatisticsManager.getDatabaseTransactionInfo(Connection connection)</code> is available to obtain this information using an existing connection.</li>
<li>Removed dependency on JAXB (<a href="http://tracker.firebirdsql.org/browse/JDBC-486">JDBC-486</a>)<br />
This removes the dependency on module <code>java.xml.bind</code> in Java 9, and in Wildfly on module <code>javax.xml.bind.api</code>.</li>
<li>Added system property <code>org.firebirdsql.jna.syncWrapNativeLibrary</code>. If this system property has a value of <code>true</code>, the native library is wrapped in a synchronisation proxy.<br />
This synchronisation proxy will serialise all access to the native library. In previous versions of Jaybird this was always applied for Embedded on platforms other than Windows.</li>
<li>Upgraded <code>antlr-runtime</code> dependency from 4.6 to 4.7 (<a href="http://tracker.firebirdsql.org/browse/JDBC-488">JDBC-488</a>)<br />
If you tested with previous snapshot or beta versions of Jaybird 3.0, make sure to replace <code>antlr-runtime-4.5.3.jar</code> or <code>antlr-runtime-4.6.jar</code> with <code>antlr-runtime-4.7.jar</code>.</li>
<li>Upgraded <code>jna</code> dependency from 4.2.2 to 4.4.0 (<a href="http://tracker.firebirdsql.org/browse/JDBC-489">JDBC-489</a>) If you use native, local or embedded and tested previous snapshot or beta versions of Jaybird 3.0, make sure to replace <code>jna-4.2.2.jar</code> with <code>jna.4.4.0.jar</code>.</li>
<li>Fixed: Presence of multiple copies of Jaybird (or its plugins) in multiple class loader hierarchies could lead to a <code>ServiceConfigurationError</code> caused by incompatible class hierarchies. (<a href="http://tracker.firebirdsql.org/browse/JDBC-490">JDBC-490</a>)<br />
This error was not caught and would bubble up the call chain, stopping Jaybird from loading, and possibly stopping the application.<br />
The error itself can still occur (because Jaybird is intentionally broad in the class loaders it tries), but the error is now caught and the next plugin is tried.</li>
</ul>
</section>
<section id="changes-in-jaybird-3.0.0-beta-3" class="level2">
<h2><span class="header-section-number">4.6</span> Changes in Jaybird 3.0.0-beta-3</h2>
<p>The following has been changed or fixed since Jaybird 3.0.0-beta-2</p>
<ul>
<li>Improved: Support for Firebird 4 object name length of 63 characters (<a href="http://tracker.firebirdsql.org/browse/JDBC-467">JDBC-467</a>)</li>
<li>Various improvements to thread safety and incomplete object validity checks. (<a href="http://tracker.firebirdsql.org/browse/JDBC-469">JDBC-469</a>) (<a href="http://tracker.firebirdsql.org/browse/JDBC-470">JDBC-470</a>)<br />
Some methods did not throw an <code>SQLException</code> when the object (<code>ResultSet</code>, <code>Statement</code>, <code>Connection</code>) was already closed. This sometimes lead to an unclear <code>RuntimeException</code> at a later point. In other cases an <code>SQLException</code> was thrown, even though the object was valid.<br />
</li>
<li>Fixed: <em>Unsupported or unexpected operation code 0 in processOperation</em> when executing stored procedure (<a href="http://tracker.firebirdsql.org/browse/JDBC-472">JDBC-472</a>)</li>
<li>Fixed: specifying <code>org.firebirdsql.jdbc.defaultConnectionEncoding</code> does not set connection character set (<a href="http://tracker.firebirdsql.org/browse/JDBC-473">JDBC-473</a>)<br />
As part of this fix we also removed the need to have the system property set before Jaybird was loaded. It will now be queried dynamically for each connection without a connection character set.</li>
<li>Fixed: <code>ClassCastException</code> on downgrade of result set concurrency (<a href="http://tracker.firebirdsql.org/browse/JDBC-474">JDBC-474</a>)</li>
<li>Improved: <code>Statement.setFetchDirection</code> and <code>ResultSet.setFetchDirection</code> now allow the values <code>ResultSet.FETCH_REVERSE</code> and <code>ResultSet.FETCH_UNKNOWN</code> (<a href="http://tracker.firebirdsql.org/browse/JDBC-475">JDBC-475</a>)<br />
These values are effectively ignored, and result set behavior is the same as with the default value of <code>ResultSet.FETCH_FORWARD</code>.</li>
<li>Updated <code>DatabaseMetaData.getSqlKeywords</code> (<a href="http://tracker.firebirdsql.org/browse/JDBC-476">JDBC-476</a>)<br />
The database metadata now returns the reserved words specific to the connected Firebird version. The reserved words, excluding those defined in SQL:2003, for versions 2.0, 2.1, 2.5 and 3.0 are available.</li>
<li>Improved: Calling <code>Blob.setBytes</code> and <code>Clob.setString</code> is now supported for position <code>1</code>, on a new blob. (<a href="http://tracker.firebirdsql.org/browse/JDBC-478">JDBC-478</a>)</li>
<li>Upgrade <code>antlr-runtime</code> dependency from 4.5.3 to 4.6 (<a href="http://tracker.firebirdsql.org/browse/JDBC-480">JDBC-480</a>)<br />
If you tested with previous snapshot or beta versions of Jaybird 3.0, make sure to replace <code>antlr-runtime-4.5.3.jar</code> with <code>antlr-runtime-4.6.jar</code>.</li>
<li>Fixed: Generated keys query for table with space (or any other character below <code>\u0022</code>) in its (quoted) name returns empty generated keys result set (<a href="http://tracker.firebirdsql.org/browse/JDBC-481">JDBC-481</a>)</li>
</ul>
</section>
<section id="changes-in-jaybird-3.0.0-beta-2" class="level2">
<h2><span class="header-section-number">4.7</span> Changes in Jaybird 3.0.0-beta-2</h2>
<p>The following has been changed or fixed since Jaybird 3.0.0-beta-1</p>
<ul>
<li>Fixed: Authentication with legacy auth users fails when Firebird 3 uses <code>AuthServer = Legacy_Auth</code> (<a href="http://tracker.firebirdsql.org/browse/JDBC-460">JDBC-460</a>)</li>
<li>Fixed: <code>jna-4.2.2.jar</code> was not included in the distribution zip (<a href="http://tracker.firebirdsql.org/browse/JDBC-461">JDBC-461</a>)</li>
<li>Changed logging of Embedded library to only log on error if none of the libraries could be loaded.</li>
<li>Fixed: native protocol is 20x-30x slower than Jaybird 2.2 native (<a href="http://tracker.firebirdsql.org/browse/JDBC-463">JDBC-463</a>)</li>
<li>Fixed: <code>ResultSetMetaData.getPrecision</code> of a numeric column when no transaction is active throws an SQLException (<a href="http://tracker.firebirdsql.org/browse/JDBC-464">JDBC-464</a>)<br />
As part of this fix, the handling of queries executed by <code>FBDatabaseMetaData</code> has been changed. Most metadata queries are now kept prepared for reuse.</li>
</ul>
</section>
</section>
<section id="whats-new-in-jaybird-3.0" class="level1">
<h1><span class="header-section-number">5</span> What’s new in Jaybird 3.0</h1>
<p>For a full list of changes, see <a href="http://tracker.firebirdsql.org/secure/ReleaseNote.jspa?projectId=10002&amp;styleName=Text&amp;version=10440">Firebird tracker for Jaybird 3.0.0</a>.</p>
<section id="java-support" class="level2">
<h2><span class="header-section-number">5.1</span> Java support</h2>
<section id="java-6" class="level3">
<h3><span class="header-section-number">5.1.1</span> Java 6</h3>
<p>Support for Java 6 has been dropped.</p>
</section>
<section id="java-7-and-8" class="level3">
<h3><span class="header-section-number">5.1.2</span> Java 7 and 8</h3>
<p>The driver supports Java 7 and 8 and provides improved support for JDBC 4.1 and JDBC 4.2 features.</p>
<p>The improved support includes</p>
<ul>
<li>Support for <code>java.time</code> in <code>set/get/updateObject</code></li>
<li>Support for <code>java.math.BigInteger</code> in <code>set/get/updateObject</code><br />
Contrary to the support required by JDBC (<code>BIGINT</code>, <code>VARCHAR</code> and <code>LONGVARCHAR</code>), we also support it for <code>SMALLINT</code>, <code>INTEGER</code>, <code>NUMERIC</code> and <code>DECIMAL</code>). In the case of numeric and decimal, the value will be rounded for non-zero decimal fractions using the logic applied by <code>BigDecimal.toBigInteger()</code>.</li>
<li>Support for <code>getObject(int/String, Class&lt;?&gt;)</code></li>
<li>Support for <code>setBinaryStream</code>/<code>setCharacterStream</code> with no length or (long) length beyond <code>Integer.MAX_VALUE</code></li>
<li>Support for large update counts (but not <code>setLargeMaxRows</code>)</li>
</ul>
</section>
<section id="java-9" class="level3">
<h3><span class="header-section-number">5.1.3</span> Java 9</h3>
<p>Jaybird currently does not fully support Java 9 and higher (JDBC 4.3), although most of the JDBC 4.3 features have been implemented (in as far as they are supported by Firebird).</p>
<p>For compatibility with Java 9+ modules, versions 2.2.14 and 3.0.3 introduced the automatic module name <code>org.firebirdsql.jaybird</code>. This guarantees a stable module name for Jaybird, and allows for future modularization of Jaybird.</p>
<p>You can use the Java 8 driver under Java 9+, contrary to earlier Jaybird 3.0 test releases, it is not necessary to add the <code>java.xml.bind</code> module using <code>--add-modules java.xml.bind</code>, as we removed its use (see caveat below for the Java 7 version of Jaybird).</p>
<p>Jaybird 3.x cannot be fully tested under Java 9+ at this moment, as some of our tests fail due to recent changes, that prevent JMock (or specifically cglib) from dynamically generating classes, this has been fixed on master (Jaybird 4).</p>
<p>We recommend to only use the Java 8 version of Jaybird with Java 9+, and not use the Java 7 version of Jaybird. The Java 7 version doesn’t implement all of the JDBC 4.3 features that are implemented in the Java 8 version. In addition, since Jaybird 3.0.4, the Java 7 version of Jaybird needs the <code>java.xml.bind</code> module, where the Java 8 version doesn’t need that module.</p>
</section>
</section>
<section id="firebird-support" class="level2">
<h2><span class="header-section-number">5.2</span> Firebird support</h2>
<p>Support for Firebird 1.0 and 1.5 has been dropped. See <a href="#firebird-1.0-and-1.5-no-longer-supported">Firebird 1.0 and 1.5 no longer supported</a> for details.</p>
<p>Firebird 2.1 support is improved with the implementation of wire protocol version 11.</p>
<p>Firebird 2.5 support is improved with the implementation of wire protocol version 12.</p>
<p>Firebird 3.0 support is improved with the (partial) implementation of wire protocol 13 and support for the <em>Srp</em> authentication plugin. Version 13 support does not yet provide Firebird 3.0 wire encryption and zlib compression. Wire encryption is planned for Jaybird 4. Support for zlib compression is not planned yet.</p>
<p>See also <a href="https://github.com/FirebirdSQL/jaybird/wiki/Jaybird-and-Firebird-3">Jaybird and Firebird 3</a> on the wiki.</p>
<p>Support for protocol version 13 and the SRP authentication was contributed by <a href="https://github.com/nakagami">Hajime Nakagami</a>.</p>
<section id="other-firebird-feature-support" class="level3">
<h3><span class="header-section-number">5.2.1</span> Other Firebird feature support</h3>
<ul>
<li>Add support for streaming backup and restore (<a href="http://tracker.firebirdsql.org/browse/JDBC-256">JDBC-256</a>)<br />
This feature was contributed by <a href="https://github.com/ls4f">Ivan Arabadzhiev</a></li>
</ul>
</section>
</section>
<section id="new-low-level-implementation" class="level2">
<h2><span class="header-section-number">5.3</span> New low-level implementation</h2>
<p>Jaybird 3.0 has a substantially rewritten low-level implementation (the wire protocol and native implementation) and a number of changes for JDBC conformance.</p>
<p>The rewrite of the low-level implementation was prompted by the new authentication (and wire encryption) in Firebird 3.0 (protocol version 13), and the fact that other improvements in the Firebird wire protocol (versions 11 and 12) were not yet available in the pure Java implementation in Jaybird. The old implementation of the wire protocol did not lend itself for - easily - supporting multiple protocol versions.</p>
<p>The new low-level implementation also means that the old GDS API (<code>org.firebirdsql.gds.GDS</code>) has been removed and is no longer available.</p>
<p>For the native, local and embedded support the use of <code>jaybirdxx.dll</code>/<code>libjaybirdxx.so</code> is no longer necessary. For more details, see <a href="#type-2-native-and-embedded-driver">Type 2 (native) and embedded driver</a>.</p>
</section>
<section id="support-for-java.util.logging-added" class="level2">
<h2><span class="header-section-number">5.4</span> Support for java.util.logging added</h2>
<p>We have added support for <code>java.util.logging</code>, and made it the default logging implementation.</p>
<p>We have applied the following mapping for the log levels:</p>
<table>
<thead>
<tr class="header">
<th>Jaybird log level</th>
<th><em>jul</em> log level</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Logger.trace</code></td>
<td><code>Level.FINER</code></td>
</tr>
<tr class="even">
<td><code>Logger.debug</code></td>
<td><code>Level.FINE</code></td>
</tr>
<tr class="odd">
<td><code>Logger.info</code></td>
<td><code>Level.INFO</code></td>
</tr>
<tr class="even">
<td><code>Logger.warn</code></td>
<td><code>Level.WARNING</code></td>
</tr>
<tr class="odd">
<td><code>Logger.error</code></td>
<td><code>Level.SEVERE</code></td>
</tr>
<tr class="even">
<td><code>Logger.fatal</code></td>
<td><code>Level.SEVERE</code></td>
</tr>
</tbody>
</table>
<p>We have also added some options to control logging behavior:</p>
<ul>
<li>System property <code>org.firebirdsql.jdbc.disableLogging</code> with value <code>true</code> will disable logging entirely.</li>
<li>System property <code>org.firebirdsql.jdbc.forceConsoleLogger</code> with value <code>true</code> will force logging to the <code>System.out</code> for info and lower and <code>System.err</code> for warn and above (<code>debug</code> and <code>trace</code> are disabled in the implementation).</li>
<li>System property <code>org.firebirdsql.jdbc.loggerImplementation</code> to specify an alternative implementation of the interface <code>org.firebirdsql.logging.Logger</code>.<br />
This implementation must be public and must have a public constructor with a single <code>String</code> argument for the logger name. See also <a href="#support-for-log4j-1.x-removed">Support for log4j 1.x removed</a> for an example.<br />
The <code>org.firebirdsql.logging.Logger</code> interface is volatile and might change in future minor releases (but not point/bugfix releases).</li>
</ul>
</section>
<section id="support-for-log4j-1.x-removed" class="level2">
<h2><span class="header-section-number">5.5</span> Support for log4j 1.x removed</h2>
<p>Support for Log4J 1.x has been removed. If you really need it, you can implement the interface <code>org.firebirdsql.logging.Logger</code> with a public constructor accepting a single <code>String</code> parameter (the logger name).</p>
<p>To instruct Jaybird to use this logger implementation, specify the system property <code>org.firebirdsql.jdbc.loggerImplementation</code> with the class name.</p>
<p>Say you have created the following implementation</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode java"><code class="sourceCode java"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">package</span><span class="im"> org.example.jaybird.logging;</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="kw">public</span> <span class="kw">class</span> Log4jLogger <span class="kw">implements</span> org.<span class="fu">firebirdsql</span>.<span class="fu">logging</span>.<span class="fu">Logger</span> {</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="kw">public</span> <span class="fu">Log4jLogger</span>(<span class="bu">String</span> name) {</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="co">// create the logger    </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    }</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    <span class="co">// implementation of interface</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">}</a></code></pre></div>
<p>You will need to specify:</p>
<pre><code>-Dorg.firebirdsql.jdbc.loggerImplementation=org.example.jaybird.logging.Log4jLogger</code></pre>
</section>
<section id="ipv6-address-literal-support-in-connection-string" class="level2">
<h2><span class="header-section-number">5.6</span> IPv6 address literal support in connection string</h2>
<p>Added support for IPv6 address literals in the connection string. This is only supported for the modern-style connection URLs, using the <a href="http://www.faqs.org/rfcs/rfc2732.html">RFC2732</a> format:</p>
<ul>
<li><code>jdbc:firebirdsql://[&lt;ipv6-address&gt;]/&lt;path-or-alias&gt;</code></li>
<li><code>jdbc:firebirdsql://[&lt;ipv6-address&gt;]:&lt;port&gt;/&lt;path-or-alias&gt;</code></li>
</ul>
<p>Examples:</p>
<pre><code>jdbc:firebirdsql://[::1]/employee
jdbc:firebirdsql://[::192.9.5.5]:3050/employee
jdbc:firebirdsql://[1080::8:800:200C:417A]/employee</code></pre>
<p>etc</p>
<p>IPv6 literals are not supported in the legacy URL format (the <code>&lt;host&gt;[/port]:&lt;path-or-alias&gt;</code> format).</p>
</section>
<section id="wire-encryption-support" class="level2">
<h2><span class="header-section-number">5.7</span> Wire encryption support</h2>
<p>Added in 3.0.4, back-ported from Jaybird 4</p>
<p>Jaybird 3.0.4 adds support for the Firebird 3 ARC4 wire encryption. The encryption is configured using the connection property <code>wireCrypt</code>, with the following (case-insensitive) values:</p>
<ul>
<li><code>DEFAULT</code>: default (value used when <code>wireCrypt</code> is not specified; you’d normally not specify this explicitly)</li>
<li><code>ENABLED</code>: enable, but not require, wire encryption</li>
<li><code>REQUIRED</code>: require wire encryption (only if Firebird version is 3.0 or higher)</li>
<li><code>DISABLED</code>: disable wire encryption</li>
</ul>
<p>The default value acts as <code>ENABLED</code> for pure Java connections, for JNA (native) connections this wil use the fbclient default (either <code>Enabled</code> or the configured value of <code>WireCrypt</code> from a <code>firebird.conf</code> read by the native library).</p>
<p>Connection property <code>wireCrypt=REQUIRED</code> will <strong>not</strong> reject unencrypted connections when connecting to Firebird 2.5 or lower. This behavior matches the Firebird 3 client library behavior. The value will also be ignored when using native connections with a Firebird 2.5 client library.</p>
<p>Using <code>wireCrypt=DISABLED</code> when Firebird 3 or higher uses setting <code>WireCrypt = Required</code> (or vice versa) will yield error <em>“Incompatible wire encryption levels requested on client and server”</em> (error: <em>isc_wirecrypt_incompatible / 335545064</em>).</p>
<p>The same error is raised when connecting to Firebird 3 and higher with a legacy authentication user with connection property <code>wireCrypt=REQUIRED</code>.</p>
<p>Alternative wire encryption plugins are currently not supported, although we made some preparations to support this. If you want to develop such a plugin, contact us on the Firebird-Java mailing list so we can work out the details of adding plugin support.</p>
<p><strong>WARNING</strong></p>
<p>The implementation comes with a number of caveats:</p>
<ul>
<li>we cannot guarantee that the session key cannot be obtained by someone with access to your application or the machine hosting your application (although that in itself would already imply a severe security breach)</li>
<li>the ARC4 encryption - the default provided by Firebird - is considered to be a weak (maybe even broken) cipher these days</li>
</ul>
</section>
<section id="database-encryption-support" class="level2">
<h2><span class="header-section-number">5.8</span> Database encryption support</h2>
<p>Added in 3.0.4. This feature was sponsored by IBPhoenix.</p>
<p>Jaybird 3.0.4 adds support for Firebird 3 database encryption callbacks in the pure Java implementation of the version 13 protocol.</p>
<p>The current implementation is simple and only supports replying with a static value from a connection property. Be aware that a static value response for database encryption is not very secure as it can easily lead to replay attacks or unintended key exposure.</p>
<p>Future versions of Jaybird (likely 4, maybe 5) will introduce plugin support for database encryption plugins that require a more complex callback.</p>
<p>The static response value of the encryption callback can be set through the <code>dbCryptConfig</code> connection property. Data sources and <code>ServiceManager</code> implementations have an equivalent property with the same name. This property can be set as follows:</p>
<ul>
<li>Absent or empty value: empty response to callback (depending on the database encryption plugin this may just work or yield an error later)</li>
<li>Strings prefixed with <code>base64:</code>: rest of the string is decoded as base64 to bytes. The <code>=</code> padding characters are optional, but when present they must be valid (that is: if you use padding, you must use the right number of padding characters for the length)</li>
<li>Plain string value: string is encoded to bytes using UTF-8, and these bytes are used as the response</li>
</ul>
<p>Because of the limitation of connection URL parsing, we strongly suggest to avoid plain string values with <code>&amp;</code> or <code>;</code>. Likewise, avoid <code>:</code> so that we can support other prefixes similar to <code>base64:</code> in the future. If you need these characters, consider using a base64 encoded value instead.</p>
<p>For service operations, as implemented in the <code>org.firebirdsql.management</code> package, Firebird requires the <code>KeyHolderPlugin</code> configuration to be globally defined in <code>firebird.conf</code>. Database-specific configuration in <code>databases.conf</code> will be ignored for service operations. Be aware that some service operations on encrypted databases are not supported by Firebird 3 (eg <code>gstat</code> equivalents other than <code>gstat -h</code> or <code>gstat -e</code>).</p>
<p>Other warnings and limitations</p>
<ul>
<li>Database encryption callback support is only available in the pure Java implementation. Support for native and embedded connections will be added in a future version.</li>
<li>The database encryption callback does not require an encrypted connection, so the key can be exchanged unencrypted if wire protocol encryption has been disabled client-side or server-side, or if legacy authentication is used. Consider setting connection property <code>wireCrypt=REQUIRED</code> to force encryption (caveat: see the next point).</li>
<li>Firebird may ask for the database encryption key before the connection has been encrypted (for example if the encrypted database itself is used as the security database). <em>This applies to v15 protocol support, which is not yet available.</em></li>
<li>The improvements of the versions 14 and 15 wire protocol are not implemented, and as a result encrypted security databases (external or security database hosted in the database itself) will not work unless the encryption plugin does not require a callback. Support for the version 15 wire protocol will be added in a future version.</li>
<li>We cannot guarantee that the <code>dbCryptConfig</code> value cannot be obtained by someone with access to your application or the machine hosting your application (although that in itself would already imply a severe security breach).</li>
</ul>
</section>
<section id="potentially-breaking-changes" class="level2">
<h2><span class="header-section-number">5.9</span> Potentially breaking changes</h2>
<p>Jaybird 3.0 contains a number of changes that might break existing applications.</p>
<p>See also <a href="#compatibility-changes">Compatibility changes</a> for details.</p>
<section id="specifying-connection-character-set-is-now-required" class="level3">
<h3><span class="header-section-number">5.9.1</span> Specifying connection character set is now required</h3>
<p>Jaybird 3.0.0 and 3.0.1 required you to specify the connection character set by either specifying <code>encoding=&lt;Firebird encoding&gt;</code> or <code>charSet=&lt;Java encoding&gt;</code>.</p>
<p>This requirement has been dropped again in 3.0.2.</p>
<p>For more information see: <a href="#connection-rejected-without-an-explicit-character-set">Connection rejected without an explicit character set</a></p>
</section>
<section id="antlr-4-runtime" class="level3">
<h3><span class="header-section-number">5.9.2</span> ANTLR 4 runtime</h3>
<p>The generated keys functionality now requires ANTLR 4.7. Make sure to replace <code>antlr-runtime-3.4.jar</code> with the <code>antlr-runtime-4.7.jar</code> included in the distribution zip. If you use maven this will happen automatically.</p>
<p>As in previous versions: if the ANTLR runtime is not on the classpath, then the generated keys functionality will not be available.</p>
</section>
<section id="handling-of-character-set-octets" class="level3">
<h3><span class="header-section-number">5.9.3</span> Handling of character set OCTETS</h3>
<p>Columns of type <code>CHAR</code> and <code>VARCHAR</code> with character set <code>OCTETS</code> are now handled as JDBC type <code>BINARY</code> and <code>VARBINARY</code>, respectively (<a href="http://tracker.firebirdsql.org/browse/JDBC-240">JDBC-240</a>)</p>
<p>See also <a href="#character-set-octets-handled-as-jdbc-varbinary">Character set OCTETS handled as JDBC (VAR)BINARY</a>.</p>
</section>
<section id="changes-to-character-set-handling" class="level3">
<h3><span class="header-section-number">5.9.4</span> Changes to character set handling</h3>
<p>We reimplemented the character set handling in Jaybird which may lead to different behavior, especially when using <code>NONE</code> as the connection character set.</p>
<p>See also <a href="#character-set-handling">Character set handling</a>.</p>
</section>
</section>
<section id="other-fixes-and-changes" class="level2">
<h2><span class="header-section-number">5.10</span> Other fixes and changes</h2>
<ul>
<li><p>Fix: IP-address is reversed on big-endian platforms (<a href="http://tracker.firebirdsql.org/browse/JDBC-98">JDBC-98</a>)</p></li>
<li><p>Improved support of JDBC Escape syntax (<code>{...}</code>) and supported functions (<a href="http://tracker.firebirdsql.org/browse/JDBC-223">JDBC-223</a>)</p>
<p>The escape parser will now only allow the function names defined in Appendix D of the JDBC specification (4.2 for now). For unsupported functions or functions not listed in Appendix D a <code>FBSQLParseException</code> will be thrown.</p>
<p>The database metadata will now correctly report supported functions for <code>getNumericFunctions</code>, <code>getStringFunctions</code>, <code>getSystemFunctions</code> and <code>getTimeDateFunctions</code>.</p></li>
<li><p>Nested JDBC escapes are now supported (<a href="http://tracker.firebirdsql.org/browse/JDBC-292">JDBC-292</a>)</p></li>
<li><p>Changed locking to coarser blocks with - as far as possible - a single lock object per connection for all connection-derived objects (<a href="http://tracker.firebirdsql.org/browse/JDBC-435">JDBC-435</a>)</p>
<p>This should prevent deadlocks on concurrent access. In some cases locks were obtained in different order (eg (statement, connection), and (connection, statement)). The downside is reduced concurrency, but as using a connection from multiple threads concurrently is discouraged anyway, that is an acceptable price to pay.</p></li>
<li><p><code>DatabaseMetaData.getColumns</code> will report <code>YES</code> for <code>IS_AUTOINCREMENT</code> and <code>IS_GENERATEDCOLUMN</code> if the column is an identity column (<a href="http://tracker.firebirdsql.org/browse/JDBC-322">JDBC-322</a>)</p></li>
<li><p>Added Jaybird-specific columns <code>JB_IS_IDENTITY</code> and <code>JB_IDENTITY_TYPE</code> to <code>DatabaseMetaData.getColumns</code> to report the type of identity column (<a href="http://tracker.firebirdsql.org/browse/JDBC-322">JDBC-322</a>)</p>
<p><code>JB_IS_IDENTITY</code> has either <code>YES</code> or <code>NO</code> as possible values and can be used to check if the column is really an identity column.</p>
<p>Possible values for <code>JB_IDENTITY_TYPE</code> are:</p>
<ul>
<li><code>null</code> : not an identity column, or unknown identity type,</li>
<li><code>ALWAYS</code> : a <code>GENERATED ALWAYS AS IDENTITY</code> column (NOTE: not yet supported by Firebird),</li>
<li><code>BY DEFAULT</code> : a <code>GENERATED BY DEFAULT AS IDENTITY</code> column.</li>
</ul>
<p>You should always retrieve these columns by name, as their position will change when the JDBC specification adds new columns.</p></li>
<li><p>Added field index to <code>DataTruncation</code> exceptions (<a href="http://tracker.firebirdsql.org/browse/JDBC-405">JDBC-405</a>)</p></li>
<li><p>Added support for <code>getGeneratedKeys</code> for batch execution of prepared statements (<a href="http://tracker.firebirdsql.org/browse/JDBC-452">JDBC-452</a>)</p></li>
</ul>
</section>
<section id="removal-of-deprecated-classes-and-packages" class="level2">
<h2><span class="header-section-number">5.11</span> Removal of deprecated classes and packages</h2>
<p>See <a href="#removal-of-deprecated-classes-packages-and-methods">Removal of deprecated classes, packages and methods</a> in <a href="#compatibility-changes">Compatibility changes</a> for more details.</p>
</section>
</section>
<section id="known-issues" class="level1">
<h1><span class="header-section-number">6</span> Known Issues</h1>
<ul>
<li><p>Firebird 3.0.1 does not correctly support <code>BOOLEAN</code> parameters, see <a href="http://tracker.firebirdsql.org/browse/CORE-5367">CORE-5367</a></p>
<p>Either use Firebird 3.0.0 or 3.0.2 and higher.</p></li>
<li><p>Using a native connection with a Firebird 3 client library to a Firebird 2.5 or older server may be slow to connect. The workaround is to specify the IPv4 address instead of the host name in the connection string, or to use a Firebird 2.5 or earlier <code>fbclient.dll</code>.</p>
<p>This is caused by <a href="http://tracker.firebirdsql.org/browse/CORE-4658">CORE-4658</a></p></li>
</ul>
</section>
<section id="compatibility-changes" class="level1">
<h1><span class="header-section-number">7</span> Compatibility changes</h1>
<p>Jaybird 3.0 introduces some changes in compatibility and announces future breaking changes.</p>
<p>The changes due to the new protocol implementation and/or JDBC conformance are listed below.</p>
<p><strong>The list might not be complete, if you notice a difference in behavior that is not listed, please <a href="http://tracker.firebirdsql.org/brows/JDBC">report it as bug</a>.</strong> It might have been a change we forgot to document, but it could just as well be an implementation bug.</p>
<section id="character-set-handling" class="level2">
<h2><span class="header-section-number">7.1</span> Character set handling</h2>
<section id="character-set-octets-handled-as-jdbc-varbinary" class="level3">
<h3><span class="header-section-number">7.1.1</span> Character set OCTETS handled as JDBC (VAR)BINARY</h3>
<p>Columns of type <code>CHAR(n) CHARACTER SET OCTETS</code> and <code>VARCHAR(n) CHARACTER SET OCTETS</code> are now handled as JDBC type <code>java.sql.Types.BINARY</code> and <code>java.sql.Types.VARBINARY</code>, respectively.</p>
<p>The connection property <code>octetsAsBytes</code> no longer has any effect, metadata and usage will always be <code>(VAR)BINARY</code>.</p>
<p>With this change the getters (on result set/callable statement) and setters (prepared/callable statement) and update methods (result set) for columns of this type have been restricted to:</p>
<ul>
<li><code>set/get/updateNull</code></li>
<li><code>get/set/updateBytes</code></li>
<li><code>get/set/updateBinaryStream</code></li>
<li><code>get/set/updateAsciiStream</code></li>
<li><code>get/set/updateString</code> (using the default encoding or connection encoding)</li>
<li><code>get/set/updateCharacterStream</code> (using the default encoding or connection encoding)</li>
<li><code>get/set/updateObject</code> (with <code>String</code>, <code>byte[]</code>, <code>InputStream</code>, <code>Reader</code>)</li>
</ul>
<p>Other getters/setters/updaters or object types supported for ‘normal’ <code>(VAR)CHAR</code> fields are not available.</p>
</section>
<section id="connection-character-set-none" class="level3">
<h3><span class="header-section-number">7.1.2</span> Connection character set NONE</h3>
<p>Jaybird will now use the <code>(VAR)CHAR</code> or <code>BLOB SUB_TYPE TEXT</code> character set information for decoding. This means that when using connection character set <code>NONE</code> that columns which have an explicit character set will be decoded and encoded using that character set instead of using the platform default encoding (or explicitly specified Java character set when specifying both <code>encoding=NONE</code> <strong>and</strong> <code>charSet=&lt;some java charset&gt;</code>).</p>
<p>This may lead to unexpected character conversions if - for example - you have always been reading and writing <code>Cp1251</code> data from a <code>WIN1252</code> column: it will now be read as <code>Cp1252</code>. You will need to convert the column and data to the right character set.</p>
</section>
<section id="connection-rejected-without-an-explicit-character-set" class="level3">
<h3><span class="header-section-number">7.1.3</span> Connection rejected without an explicit character set</h3>
<p>Jaybird version 3.0.0 and 3.0.1 would not connect if no connection character set had been specified. This requirement has been dropped again. See <a href="#connecting-without-explicit-character-set">Connecting without explicit character set</a> for more information on the behavior in Jaybird 3.0.2 and higher.</p>
</section>
<section id="connecting-without-explicit-character-set" class="level3">
<h3><span class="header-section-number">7.1.4</span> Connecting without explicit character set</h3>
<p>If no connection character set has been specified (using connection property <code>encoding</code> or <code>charSet</code> or their aliases), then - by default - Jaybird 3.0.2 and higher will default to connection character set <code>NONE</code>. Be aware that <code>NONE</code> in Jaybird 3 does not behave the same as in Jaybird 2.2 and earlier, see <a href="#connection-character-set-none">Connection character set NONE</a> for information.</p>
<p>Note that using <code>NONE</code> can result in incorrect character set handling when the database is used from different locales.</p>
<p>You can explicitly set the connection character set using one of the following options:</p>
<ul>
<li><p>Use connection property <code>encoding</code> (alias: <code>lc_ctype</code>) with a Firebird character set name.</p></li>
<li><p>Use connection property <code>charSet</code> (alias: <code>localEncoding</code>) with a Java character set name.</p></li>
<li><p>Use a combination of <code>encoding</code> and <code>charSet</code>, if you want to reinterpret a Firebird character set in a Java character set other than the default mapping.</p></li>
</ul>
<p>To control how Jaybird handles connections without explicit character sets, you can use the following options:</p>
<ul>
<li><p>You can configure a default Firebird character set - overriding the default of <code>NONE</code> - with system property <code>org.firebirdsql.jdbc.defaultConnectionEncoding</code>. Jaybird will apply the specified character set as the default when no character set is specified in the connection properties.</p>
<p>This property only supports Firebird character set names.</p></li>
<li><p>You can require an explicit character set to be specified with system property <code>org.firebirdsql.jdbc.requireConnectionEncoding</code> set to <code>true</code>. With this property specified, a connection character set must have been specified using connection properties or using the system property <code>org.firebirdsql.jdbc.defaultConnectionEncoding</code>.</p>
<p>This is the behaviour that was the default in Jaybird 3.0.0 and 3.0.1.</p>
<p>This property will cause Jaybird to reject the connection, if no character set has been set, with an <code>SQLNonTransientConnectionException</code> with message <em>“Connection rejected: No connection character set specified (property lc_ctype, encoding, charSet or localEncoding). Please specify a connection character set (eg property charSet=utf-8) or consult the Jaybird documentation for more information.”</em>.</p></li>
</ul>
</section>
</section>
<section id="logging" class="level2">
<h2><span class="header-section-number">7.2</span> Logging</h2>
<p>Support for log4j has been removed, and we now default to <code>java.util.logging</code>. The previous default was no logging.</p>
<p>See also <a href="#support-for-java.util.logging-added">Support for java.util.logging added</a> and <a href="#support-for-log4j-1.x-removed">Support for log4j 1.x removed</a>.</p>
</section>
<section id="exceptions" class="level2">
<h2><span class="header-section-number">7.3</span> Exceptions</h2>
<ul>
<li><p><code>FBSQLException</code> and sub-classes replaced with actual <code>java.sql.*</code> exceptions.</p>
<p>Over time the JDBC exception hierarchy has become more complicated with more specific exceptions. It was easier to use the <code>java.sql</code> exception- hierarchy, than to duplicate the hierarchy within Jaybird.</p>
<p>This change does not mean that there are no Firebird-specific <code>SQLException</code> sub-classes anymore, but in general we strive to use the standard exceptions where possible.</p></li>
<li><p>Class <code>FBSQLWarning</code> has been removed and replaced with <code>java.sql.SQLWarning</code>.</p></li>
<li><p>Methods with <code>throws FBSQLException</code> changed to <code>throws SQLException</code></p>
<p>As we are preferring the standard exceptions, the throws clause has been widened to <code>SQLException</code>. Note that most methods already had <code>throws SQLException</code>, so the impact is limited. This change specifically impacts:</p>
<ul>
<li><code>org.firebirdsql.jdbc.FirebirdPreparedStatement</code>
<ul>
<li><code>getExecutionPlan()</code></li>
<li><code>getStatementType()</code></li>
</ul></li>
<li><code>org.firebirdsql.management.FBServiceManager</code>
<ul>
<li><code>executeServicesOperation</code></li>
</ul></li>
<li>A number of classes/methods internal to the Jaybird implementation</li>
</ul></li>
<li><p><code>org.firebirdsql.gds.GDSException</code> has been removed from exception causes.</p>
<p>The new low-level implementation throws <code>java.sql.SQLException</code> classes eliminating the need for <code>GDSException</code> (which was usually set as the <code>cause</code> of an <code>SQLException</code>). In some cases uses of <code>GDSException</code> have been replaced by <code>org.firebirdsql.jdbc.FBSQLExceptionInfo</code> to report exception message elements and their error codes.</p></li>
<li><p>Exception message format changed:</p>
<ul>
<li><p>Exception message elements are now separated by semi-colon, not by linebreak.</p>
<p>Errors reported by Firebird can consist of multiple elements. In Jaybird 2.2 and earlier the final exception message was constructed by separating these elements by a linebreak. These elements are now separated by a semi-colon and a space.</p></li>
<li><p>Exception message now reports SQLState and error code.</p></li>
</ul>
<p>For example, a “Table unknown” (error 335544580) in Jaybird 3.0 has message:</p>
<pre><code>Dynamic SQL Error; SQL error code = -204; Table unknown; TABLE_NON_EXISTENT; At line 1, column 13 [SQLState:42S02, ISC error code:335544580]</code></pre>
<p>Jaybird 2.2 and earlier reported this as (<code>\n</code> added to show line break):</p>
<pre><code>Dynamic SQL Error\n
SQL error code = -204\n
Table unknown\n
TABLE_NON_EXISTENT\n
At line 1, column 13</code></pre>
<p>The SQLState and error code are only included in the message if the exception is constructed using <code>FbExceptionBuilder</code> (for example errors received from Firebird). Some parts of the code construct an <code>SQLException</code> directly, those messages do not contain the SQLState and error code in the message. We strive to improve that in future versions.</p></li>
<li><p>More specific error reported by <code>SQLException.getErrorCode</code> and <code>SQLException.getSQLState</code>.</p>
<p>In previous versions a large class of errors always reported error 335544569 (“Dynamic SQL Error” or <code>isc_dsql_error</code>) with SQLState 42000, Jaybird now tries to find a more specific error code (and SQLState) in the status vector.</p></li>
<li><p>Added Jaybird specific error codes for some exceptions. The error code range <code>337248256</code> - <code>337264639</code> has been reserved by the Firebird project for use by Jaybird.</p>
<p>We will migrate more Jaybird-specific exceptions to these error codes in future versions.</p></li>
</ul>
</section>
<section id="firebird-1.0-and-1.5-no-longer-supported" class="level2">
<h2><span class="header-section-number">7.4</span> Firebird 1.0 and 1.5 no longer supported</h2>
<p>Support for Firebird 1.0 and 1.5 has been dropped in Jaybird 3.0. In general we expect the driver to remain functional, but chances are certain metadata (eg <code>DatabaseMetaData</code>) will break if we use features introduced in newer versions.</p>
<p>In general we will no longer fix issues that only occur with Firebird 1.5 or earlier.</p>
</section>
<section id="java-5-and-6-no-longer-supported" class="level2">
<h2><span class="header-section-number">7.5</span> Java 5 and 6 no longer supported</h2>
<p>Support for Java 6 (JDBC 4.0) has been dropped in Jaybird 3.0. The Jaybird 3.0 sources no longer compile with Java 6 due to use of Java 7 language features and JDBC 4.1 specific features.</p>
<p>Support for Java 5 was already removed with Jaybird 2.2.8.</p>
</section>
<section id="stricter-jdbc-compliance" class="level2">
<h2><span class="header-section-number">7.6</span> Stricter JDBC compliance</h2>
<p>In Jaybird 3.0 a number of changes were made for stricter compliance to the JDBC specification.</p>
<section id="general" class="level3">
<h3><span class="header-section-number">7.6.1</span> General</h3>
<p>Most methods in JDBC objects are required to throw an <code>SQLException</code> if the object is closed or otherwise invalid. Not all Jaybird methods followed this requirement. We have improved this in Jaybird 3.0, but there are still some cases left to fix (which we might do in point releases).</p>
</section>
<section id="statement" class="level3">
<h3><span class="header-section-number">7.6.2</span> Statement</h3>
<p><em>Unless explicitly indicated, changes also apply to <code>PreparedStatement</code> and <code>CallableStatement</code></em></p>
<ul>
<li><p>Generated keys <code>ResultSet</code> is only available through <code>getGeneratedKeys</code>.</p>
<p>The generated keys <code>ResultSet</code> from a statement is no longer available through <code>getResultSet</code>, but only through <code>getGeneratedKeys</code> as the JDBC specification does not consider the generated keys <code>ResultSet</code> a normal <code>ResultSet</code>.</p>
<p><span id="generated-query-types">This applies to statements executed (or prepared) using:</span></p>
<ul>
<li><code>Statement.execute(String, int)</code> or <code>Statement.executeUpdate(String, int)</code> with value <code>Statement.RETURN_GENERATED_KEYS</code>,</li>
<li><code>Statement.execute(String, int[])</code> or <code>Statement.executeUpdate(String, int[])</code>,</li>
<li><code>Statement.execute(String, String[])</code> or <code>Statement.executeUpdate(String, String[])</code>,</li>
<li><code>Connection.prepareStatement(String, int)</code> with value <code>Statement.RETURN_GENERATED_KEYS</code>,</li>
<li><code>Connection.prepareStatement(String, int[])</code>,</li>
<li><code>Connection.prepareStatement(String, String[])</code>.</li>
</ul>
<p>This change does not apply to executing <code>INSERT ... RETURNING ...</code> as a normal statement.</p></li>
<li><p>Update count immediately available after executing generated keys queries.</p>
<p>Previously the update count of a generated keys query was only available after calling <code>getMoreResults</code> followed by a call to <code>getUpdateCount</code>. This change means that <code>executeUpdate</code> will now correctly return the update count (usually <code>1</code>) instead of <code>-1</code>. The same applies to calling <code>getUpdateCount</code> after <code>execute</code> (without the need to call <code>getMoreResults</code>).</p>
<p>For the definition of generated keys queries see <a href="#generated-query-types">the previous item</a>.</p></li>
<li><p>Use of function escapes (<code>{fn ...}</code>) not defined in the JDBC standard will now throw an <code>FBSQLParseException</code>, previously the escape was removed and the function was used as is.</p></li>
</ul>
</section>
<section id="preparedstatement" class="level3">
<h3><span class="header-section-number">7.6.3</span> PreparedStatement</h3>
<p><em>Unless explicitly indicated, changes also apply to <code>CallableStatement</code></em></p>
<ul>
<li><p>Method <code>setUnicodeStream</code> now always throws an <code>SQLFeatureNotSupportedException</code>. The previous implementation did not conform to the (deprecated) JDBC requirements and instead behaved like <code>setBinaryStream</code>.</p>
<p>For the behavior in Jaybird 2.2 and earlier, use <code>setBinaryStream</code>. Otherwise use <code>setCharacterStream</code>.</p></li>
<li><p>Methods <code>setNString</code>, <code>setNClob</code>, and <code>setNCharacterStream</code> will now behave as their counterpart without <code>N</code> (ie <code>setString</code>, <code>setClob</code>, and <code>setCharacterStream</code>)</p>
<p>This implementation is not compliant with the JDBC requirements for <code>NVARCHAR/NCHAR/NCLOB</code> support, it is only provided for compatibility purposes.</p></li>
</ul>
</section>
<section id="callablestatement" class="level3">
<h3><span class="header-section-number">7.6.4</span> CallableStatement</h3>
<ul>
<li><p>Methods <code>getNString</code>, <code>getNClob</code>, and <code>getNCharacterStream</code> will now behave as their counterpart without <code>N</code> (ie <code>getString</code>, <code>getClob</code>, and <code>getCharacterStream</code>)</p>
<p>This implementation is not compliant with the JDBC requirements for <code>NVARCHAR/NCHAR/NCLOB</code> support, it is only provided for compatibility purposes.</p></li>
</ul>
</section>
<section id="resultset" class="level3">
<h3><span class="header-section-number">7.6.5</span> ResultSet</h3>
<ul>
<li><p>Method <code>getUnicodeStream</code> now always throws an <code>SQLFeatureNotSupportedException</code>. The previous implementation did not conform to the (deprecated) JDBC requirements and instead behaved like <code>getBinaryStream</code>.</p>
<p>For the behavior in Jaybird 2.2 and earlier, use <code>getBinaryStream</code>. Otherwise use <code>getCharacterStream</code>.</p></li>
<li><p>Methods <code>getNString</code>, <code>updateNString</code>, <code>getNClob</code>, <code>updateNClob</code>, <code>getNCharacterStream</code>, and <code>updateNCharacterStream</code> will now behave as their counterpart without <code>N</code> (ie <code>getString</code>, <code>updateString</code>, <code>getClob</code>, <code>updateClob</code>, <code>getCharacterStream</code>, and <code>updateCharacterStream</code>)</p>
<p>This implementation is not compliant with the JDBC requirements for <code>NVARCHAR/NCHAR/NCLOB</code> support, it is only provided for compatibility purposes.</p></li>
</ul>
</section>
<section id="clob" class="level3">
<h3><span class="header-section-number">7.6.6</span> Clob</h3>
<ul>
<li><p>The <code>Clob</code> implementations of the driver now also implement <code>NClob</code> so they can be returned from <code>getNClob</code>.</p>
<p>This implementation is not compliant with the JDBC requirements for <code>NVARCHAR/NCHAR/NCLOB</code> support, it is only provided for compatibility purposes.</p></li>
</ul>
</section>
<section id="databasemetadata" class="level3">
<h3><span class="header-section-number">7.6.7</span> DatabaseMetaData</h3>
<section id="pattern-parameters" class="level4">
<h4><span class="header-section-number">7.6.7.1</span> Pattern parameters</h4>
<p>The <code>java.sql.DatabaseMetaData</code> implementation has been changed to follow the JDBC requirements for object name pattern or object name parameters (referred to as <em>patterns</em> in the rest of this section).</p>
<p>These changes affect all methods that accept one or more pattern or name parameters and return a <code>ResultSet</code>. This includes, but is not limited to, <code>getTables</code> and <code>getColumns</code>.</p>
<p>In Firebird unquoted object names are stored upper case, while quoted object names are stored as is. The JDBC specification states that the pattern must match the object name as stored in the database. This means the pattern should be case sensitive.</p>
<p>The changes made are as follows:</p>
<ul>
<li><code>null</code> will always be interpreted as <code>&quot;%&quot;</code> (before this rule was applied inconsistently)</li>
<li>Empty string will no longer match (ie it is no longer interpreted as <code>&quot;%&quot;</code>) unless explicitly allowed by the method javadoc (usually only the <code>catalogPattern</code> and <code>schemaPattern</code>, which are always ignored by Jaybird as Firebird currently doesn’t support this)</li>
<li>Double quotes around a pattern will no longer be stripped, and therefor will now never match existing object names (unless those double quotes are part of the actual object name)</li>
<li>The driver will no longer try the uppercase variant of the provided pattern(s) if the original value(s) did not yield a result</li>
<li>Object name parameters that are not patterns (as indicated by the absence of <code>Pattern</code> in the parameter name) will no longer have backslashes removed</li>
</ul>
<p>Review your <code>DatabaseMetaData</code> usage and make the following changes:</p>
<ul>
<li>Empty string parameters: replace with <code>&quot;%&quot;</code> (or <code>null</code>)</li>
<li>Double quotes around patterns: remove the double quotes</li>
<li>Casing of patterns should be reviewed for correctness</li>
<li>Non-pattern parameters containing <code>\</code> should be reviewed for correctness</li>
</ul>
<p>Some examples:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sql"><code class="sourceCode sql"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">CREATE</span> <span class="kw">TABLE</span> tablename ( <span class="co">-- tablename is stored as TABLENAME in metadata</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">   column1 INTEGER,      <span class="co">-- column1 is stored as COLUMN1 in metadata</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">   <span class="ot">&quot;column2&quot;</span> INTEGER     <span class="co">-- &quot;column2&quot; is stored as column2 in metadata</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">);</a></code></pre></div>
<p>In Jaybird 2.2 using <code>getColumns(null, null, &quot;tablename&quot;, &quot;column%&quot;)</code> returns <code>COLUMN1</code>(!). In Jaybird 3.0 this produces <strong>no rows</strong> as <code>tablename</code> does not match <code>TABLENAME</code>.</p>
<p>Changing the query to <code>getColumns(null, null, &quot;TABLENAME&quot;, &quot;column%&quot;)</code> in Jaybird 2.2 and 3.0 produces only one row (<code>column2</code>), as <code>COLUMN1</code> does not match <code>column%</code>.</p>
<p>In Jaybird 2.2 using <code>getColumns(null, null, &quot;\&quot;TABLENAME\&quot;&quot;, &quot;column%&quot;)</code> returns <code>column2</code>, in Jaybird 3.0 this produces <strong>no rows</strong> as quotes are no longer stripped.</p>
<p>In Jaybird 2.2 using <code>getColumns(null, null, &quot;TABLENAME&quot;, &quot;&quot;)</code> returns all columns of the table, in Jaybird 3.0 this produces <strong>no rows</strong> as empty string does not match any column. Instead, you should use <code>getColumns(null, null, &quot;TABLENAME&quot;, &quot;%&quot;)</code>.</p>
</section>
<section id="gettables" class="level4">
<h4><span class="header-section-number">7.6.7.2</span> getTables</h4>
<p>Apart from the change described above, the following has changed for <code>getTables</code></p>
<ul>
<li>The result set is now sorted by <code>TABLE_TYPE</code> and then by <code>TABLE_NAME</code> as required by the JDBC API doc, previously we only only sorted on <code>TABLE_NAME</code>.</li>
<li>Support for table type <code>&quot;GLOBAL TEMPORARY&quot;</code> added for databases with ODS 11.2 or higher (Firebird 2.5 or higher). In previous versions, the global temporary tables were reported as normal tables (type <code>&quot;TABLE&quot;</code>)</li>
</ul>
</section>
</section>
</section>
<section id="removal-of-old-gds-api" class="level2">
<h2><span class="header-section-number">7.7</span> Removal of old GDS API</h2>
<p>The old GDS API (<code>org.firebirdsql.gds.GDS</code>) and its implementations have been removed. This removal includes a number of related classes and methods. Classes and interfaces in the <code>org.firebirdsql.gds</code> package and sub-packages that still exist may have moved to other packages, or may have a changed API.</p>
<p>In general we advise you to not use the low-level implementation directly. If you see something that is only possible through the low-level API, please file an improvement ticket or create a pull request to add it to the JDBC or management classes.</p>
</section>
<section id="type-2-native-and-embedded-driver" class="level2">
<h2><span class="header-section-number">7.8</span> Type 2 (native) and embedded driver</h2>
<p>Jaybird no longer needs a <code>jaybirdxx.dll</code> or <code>libjaybirdxx.so</code> for the Type 2 and embedded driver. Jaybird now uses JNA to access the client library.</p>
<p>If you want to use the Type 2 driver, or Firebird embedded, then you need to include <code>jna-4.4.0.jar</code> on the classpath.</p>
<p>When using Maven, you need to specify the dependency on JNA yourself, as we don’t depend on it by default:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">&lt;dependency&gt;</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    <span class="kw">&lt;groupId&gt;</span>net.java.dev.jna<span class="kw">&lt;/groupId&gt;</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="kw">&lt;artifactId&gt;</span>jna<span class="kw">&lt;/artifactId&gt;</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="kw">&lt;version&gt;</span>4.4.0<span class="kw">&lt;/version&gt;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">&lt;/dependency&gt;</span></a></code></pre></div>
<p>The <code>fbclient.dll</code>, <code>fbembed.dll</code>, <code>libfbclient.so</code>, or <code>libfbembed.so</code> need to be on the path, or the location needs to be specified in the system property <code>jna.library.path</code> (as an absolute or relative path to the directory/directories containing the library file(s)).</p>
<p>In the future we will move the Type 2 support to a separate library and provide JNA-compatible jars that provide the native libraries of a specific Firebird version.</p>
</section>
<section id="removal-of-deprecated-classes-packages-and-methods" class="level2">
<h2><span class="header-section-number">7.9</span> Removal of deprecated classes, packages and methods</h2>
<section id="datasource-and-connection-pooling" class="level3">
<h3><span class="header-section-number">7.9.1</span> DataSource and connection pooling</h3>
<p>The classes in <code>org.firebirdsql.pool</code> and <code>org.firebirdsql.pool.sun</code> have been removed completely, with the exception of <code>org.firebirdsql.pool.FBSimpleDataSource</code>. This class has been moved to <code>org.firebirdsql.ds.FBSimpleDataSource</code>. A subclass with the same name is kept in <code>org.firebirdsql.pool</code> for backwards compatibility. This subclass will be removed in Jaybird 4.</p>
<p>With this change, there are no <code>javax.sql.DataSource</code> implementations in Jaybird that provide connection pooling (the <code>javax.sql.ConnectionPoolDataSource</code> implementations are for use by a connection pool and not a connection pool themselves). Either use the connection pool provided by your application server, or use a third-party connection pool like <a href="http://www.mchange.com/projects/c3p0/">c3p0</a>, <a href="https://commons.apache.org/proper/commons-dbcp/">Apache DBCP</a> or <a href="https://brettwooldridge.github.io/HikariCP/">HikariCP</a>.</p>
<p>The class <code>org.firebirdsql.jca.FBXADataSource</code> has been removed as well. Its replacement is <code>org.firebirdsql.ds.FBXADataSource</code> (which was introduced in Jaybird 2.2).</p>
</section>
<section id="firebirdsavepoint" class="level3">
<h3><span class="header-section-number">7.9.2</span> FirebirdSavepoint</h3>
<p>All method definitions in the interface <code>org.firebirdsql.jdbc.FirebirdSavepoint</code> were removed, and methods referencing this interface in <code>org.firebirdsql.jdbc.FirebirdConnection</code> have been removed as the interface duplicated the <code>java.sql.Savepoint</code> interface and related methods in <code>java.sql.Connection</code>. The interface itself remains for potential future Firebird-specific extensions.</p>
</section>
<section id="reducing-visibility-of-implementation" class="level3">
<h3><span class="header-section-number">7.9.3</span> Reducing visibility of implementation</h3>
<p>The following classes, interfaces and/or methods had their visibility reduced as they are implementation artifacts, and should not be considered API:</p>
<ul>
<li><code>org.firebirdsql.jdbc.FBDriverPropertyManager</code> (to package private)</li>
</ul>
</section>
<section id="fbmaintenancemanager" class="level3">
<h3><span class="header-section-number">7.9.4</span> FBMaintenanceManager</h3>
<p>In <code>FBMaintenanceManager</code> the following changes have been made:</p>
<ul>
<li><code>getLimboTransactions()</code> will return <code>long[]</code> instead of <code>int[]</code></li>
<li><code>limboTransactionsAsList()</code> will return <code>List&lt;Long&gt;</code> instead of <code>List&lt;Integer&gt;</code></li>
<li><code>getLimboTransactionsAsLong()</code> (introduced in 2.2.11) has been removed in favor of <code>getLimboTransactions()</code></li>
<li><code>limboTransactionsAsLongList</code> (introduced in 2.2.11) has been removed in favor of <code>limboTransactionsAsList</code></li>
</ul>
<p>These methods were previously not defined in the <code>MaintenanceManager</code> interface.</p>
</section>
</section>
<section id="miscellaneous" class="level2">
<h2><span class="header-section-number">7.10</span> Miscellaneous</h2>
<ul>
<li>In some cases <code>ResultSetMetaData.getPrecision</code> will estimate the precision. In Jaybird 2.2 and earlier the estimate used for <code>NUMERIC</code> and <code>DECIMAL</code> was <code>19</code>, this has been revised to the more correct value of <code>18</code>.</li>
<li><code>ResultSetMetaData.getColumnDisplaySize</code> was revised to take into account space for sign and decimal separator for numeric types.</li>
</ul>
</section>
<section id="breaking-changes-for-jaybird-3.1" class="level2">
<h2><span class="header-section-number">7.11</span> Breaking changes for Jaybird 3.1</h2>
<p>The version previously announced as 3.1 will be released as Jaybird 4.</p>
</section>
<section id="breaking-changes-for-jaybird-4" class="level2">
<h2><span class="header-section-number">7.12</span> Breaking changes for Jaybird 4</h2>
<p>With Jaybird 4 the following breaking changes will be introduced.</p>
<section id="dropping-support-for-firebird-2.0-and-2.1" class="level3">
<h3><span class="header-section-number">7.12.1</span> Dropping support for Firebird 2.0 and 2.1</h3>
<p>Jaybird 4 will drop support for Firebird 2.0 and 2.1. In general we expect the driver to remain functional, but chances are certain metadata (eg <code>DatabaseMetaData</code>) will break if we use features introduced in newer versions.</p>
</section>
<section id="dropping-support-for-java-7" class="level3">
<h3><span class="header-section-number">7.12.2</span> Dropping support for Java 7</h3>
<p>Jaybird 4 will be the last version to support Java 7, Jaybird 5 will drop support for Java 7.</p>
</section>
<section id="removal-of-deprecated-methods" class="level3">
<h3><span class="header-section-number">7.12.3</span> Removal of deprecated methods</h3>
<p>The following methods will be removed in Jaybird 4:</p>
<ul>
<li><p>Character set mapping (translation) will be removed entirely. Connection property <code>useTranslation</code> (and it’s alias <code>mapping_path</code>) will no longer be available.</p>
<p>Similar effects can be achieved by a custom encoding implementation.</p>
<p>As part of this change the following parts of the implementation will be removed (note that most are internal to Jaybird):</p>
<ul>
<li><code>org.firebirdsql.encodings.CharacterTranslator</code> will be removed entirely</li>
<li><code>DatatypeCoder#encodeString(String value, String javaEncoding, String mappingPath)</code></li>
<li><code>DatatypeCoder#encodeString(String value, Encoding encoding, String mappingPath)</code></li>
<li><code>DatatypeCoder#decodeString(byte[] value, String javaEncoding, String mappingPath)</code></li>
<li><code>DatatypeCoder#decodeString(byte[] value, Encoding encoding, String mappingPath)</code></li>
<li><code>Encoding#withTranslation(CharacterTranslator translator)</code></li>
<li><code>EncodingFactory#getEncoding(String encoding, String mappingPath)</code></li>
<li><code>EncodingFactory#getEncoding(Charset charset, String mappingPath)</code></li>
<li><code>FirebirdConnectionProperties#setUseTranslation(String translationPath)</code> (and on data sources)</li>
<li><code>FirebirdConnectionProperties#getUseTranslation</code> (and on data sources)</li>
<li><code>IEncodingFactory#getCharacterTranslator(String mappingPath)</code></li>
</ul></li>
<li><p>The following connection properties will be removed:</p>
<ul>
<li><code>useTranslation</code>: See previous item</li>
<li><code>octetsAsBytes</code>: Since Jaybird 3 octets is always handled as <code>BINARY</code></li>
<li><code>noResultSetTracking</code>: Option does nothing since Jaybird 3</li>
<li><code>paranoia_mode</code>: Option does nothing since Jaybird 2.2 (maybe earlier)</li>
</ul></li>
<li><code>GDSHelper.iscVaxInteger(byte[] buffer, int pos, int length)</code> use <code>VaxEncoding.iscVaxInteger(byte[] buffer, int startPosition, int length)</code> instead.</li>
<li><code>GDSHelper.iscVaxLong(byte[] buffer, int pos, int length)</code> use <code>VaxEncoding.iscVaxLong(byte[] buffer, int startPosition, int length)</code> instead.</li>
<li><code>MaintenanceManager.commitTransaction(int transactionId)</code>, use <code>MaintenanceManager.commitTransaction(long transactionId)</code> instead.</li>
<li><code>MaintenanceManager.rollbackTransaction(int transactionId)</code>, use <code>MaintenanceManager.rollbackTransaction(long transactionId)</code> instead.</li>
<li><code>FBBlob#copyCharacterStream(Reader reader, long length, String encoding)</code></li>
<li><p><code>FBBlob#copyCharacterStream(Reader reader, String encoding)</code></p></li>
</ul>
</section>
<section id="removal-of-deprecated-constants" class="level3">
<h3><span class="header-section-number">7.12.4</span> Removal of deprecated constants</h3>
<p>The following constants will be removed in Jaybird 4:</p>
<ul>
<li>All <code>SQL_STATE_*</code> constants in <code>FBSQLException</code>, <code>FBResourceTransactionException</code>, <code>FBResourceException</code>, and <code>FBDriverNotCapableException</code> will be removed. Use equivalent constants in <code>org.firebirdsql.jdbc.SQLStateConstants</code>.</li>
</ul>
</section>
</section>
</section>
</body>
</html>
